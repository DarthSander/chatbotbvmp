<!DOCTYPE html><html lang="nl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Geboorteplan-agent</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <style>
    /* STIJLEN ZIJN HIER GECONTROLEERD – GEOPTIMALISEERD VOOR FLIP EN CHIPS */
    :root {
      --rose: #d5848d;
      --rose-light: #e8a8b0;
      --sage: #8cbf9d;
      --sage-light: #cfe6d0;
      --cream: #fef9f5;
      --beige: #fdf7f2;
      --rose-sub: #fbeaec;
      --text: #2d3436;
      --text-light: #636e72;
      --grad-main: linear-gradient(135deg, var(--cream), var(--beige) 50%, var(--rose-sub) 100%);
      --shadow: 0 6px 22px rgba(0, 0, 0, .1);
    }
    html, body {
      height: 100%; margin: 0; padding: 0;
      font-family: Inter, system-ui, sans-serif;
      background: var(--grad-main); color: var(--text);
    }
    #layout { display: flex; height: 100%; padding: 16px; gap: 24px; box-sizing: border-box; }
    #chat-col { flex: 2; display: flex; flex-direction: column; }
    #sidebar-container { flex: 1; perspective: 1500px; }
    #flip-card { width: 100%; height: 100%; position: relative; transform-style: preserve-3d; transition: transform .7s; }
    #flip-card.is-flipped { transform: rotateY(180deg); }
    .sidebar-face {
      position: absolute; width: 100%; height: 100%; backface-visibility: hidden;
      background: #fff; border-radius: 16px; padding: 20px; box-shadow: var(--shadow);
    }
    .face-back { transform: rotateY(180deg); }
    .bubble {
      padding: 12px 16px; margin: 8px 0; border-radius: 12px; max-width: 80%; line-height: 1.4;
      word-wrap: break-word; box-shadow: var(--shadow);
    }
    .bubble.user { background: #fff; margin-left: auto; }
    .bubble.bot { background: var(--rose-sub); margin-right: auto; }
    .chips-container { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 8px; }
    .chip {
      padding: 6px 14px; border-radius: 9999px; font-size: 14px;
      cursor: pointer; user-select: none; border: 1px solid #ddd;
    }
    .chip.selected { background: var(--rose); color: #fff; border-color: transparent; }
    .chip.theme { border-color: var(--rose); color: var(--rose); }
    .chip.topic { border-color: var(--sage); color: var(--sage); }
    .chip.theme.selected { background: var(--rose); }
    .chip.topic.selected { background: var(--sage); }
    .confirm-btn {
      background: var(--sage); color: #fff; border: none;
      padding: 10px 16px; border-radius: 8px; cursor: pointer;
      font-size: 15px; margin-top: 16px; width: 100%;
    }
    .confirm-btn:disabled { background: #ccc; cursor: not-allowed; }
    .loader-container { display: none; justify-content: center; margin: 20px 0; }
    .loader {
      width: 32px; height: 32px; border: 4px solid #ccc;
      border-top-color: var(--sage); border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    @keyframes spin { to { transform: rotate(360deg); } }
  </style>
</head>
<body>
  <main id="layout">
    <div id="chat-col">
      <div id="chatbox"></div>
      <div class="loader-container" id="chat-loader"><div class="loader"></div></div>
      <div class="chips-container" id="quick-replies"></div>
      <div style="display:flex; gap:8px; margin-top:auto; border-top:1px solid #ddd; padding:8px 0;">
        <textarea id="input" rows="1" placeholder="Typ je bericht…" style="flex:1; padding:10px; font-size:16px; border-radius:4px; font-family:inherit;"></textarea>
        <button id="send" style="background:var(--rose); color:#fff; border:none; padding:0 16px; font-size:16px; border-radius:4px;">Verstuur</button>
      </div>
    </div>
    <div id="sidebar-container">
      <div id="flip-card">
        <div class="sidebar-face face-front" id="plan-front"></div>
        <div class="sidebar-face face-back" id="plan-back"></div>
      </div>
    </div>
  </main>
<script>
const API_URL = "/agent";
let sessionId = sessionStorage.getItem("agentSession") || null;function addMsg(role, text) { const chatbox = document.getElementById("chatbox"); const bubble = document.createElement("div"); bubble.className = bubble ${role}; bubble.innerHTML = marked.parse(text); chatbox.appendChild(bubble); chatbox.scrollTop = chatbox.scrollHeight; } function showLoader() { document.getElementById("chat-loader").style.display = "flex"; } function hideLoader() { document.getElementById("chat-loader").style.display = "none"; } function renderChips(list = [], containerId = "quick-replies") { const container = document.getElementById(containerId); container.innerHTML = ""; list.forEach(txt => { const el = document.createElement("div"); el.className = "chip"; el.textContent = txt; el.onclick = () => handleSend(txt); container.appendChild(el); }); } async function handleSend(msg) { if (!msg) return; addMsg("user", msg); renderChips([]); showLoader(); const res = await fetch(API_URL, { method: "POST", headers: { "Content-Type": "application/json" }, body: JSON.stringify({ message: msg, session_id: sessionId }) }); const data = await res.json(); hideLoader(); sessionId = data.session_id; sessionStorage.setItem("agentSession", sessionId); addMsg("bot", data.assistant_reply); renderChips(data.suggested_replies || []); if (data.stage === "QA_SESSION") document.getElementById("flip-card").classList.remove("is-flipped"); if (data.stage === "TOPIC_SELECTION") document.getElementById("flip-card").classList.add("is-flipped"); } window.addEventListener("DOMContentLoaded", () => { handleSend("Hallo, ik wil graag een geboorteplan opstellen."); document.getElementById("send").onclick = () => handleSend(document.getElementById("input").value); }); </script>

</body>
</html>